/*=================================================================================================*\
|* GPSLog.ic                                                                                       *|
|*-------------------------------------------------------------------------------------------------*|
|* Purpose: Creates an array of ints that correspond to values obtained by the GPS                 *|
\*=================================================================================================*/

/*=================================================================================================*\
|* Constants                                                                                       *|
|*-------------------------------------------------------------------------------------------------*|
|* GPS_LOG        | This constant's definition is proof that the file is being used.               *|
|*----------------+--------------------------------------------------------------------------------*|
|* GPS_LOG_LENGTH | This constant's value is the amount of data being stored in the GPS log.       *|
\*=================================================================================================*/

#define GPS_LOG 1
#define GPS_LOG_LENGTH 50

/*=================================================================================================*\
|* Globals                                                                                         *|
|--------------------------------------------------------------------------------------------------*|
|* int gpsLog[]    | This int's contents are the GPS values gathered on the previous execution.    *|
|*-----------------+-------------------------------------------------------------------------------*|
|* int gpsLogIndex | This int is the current location being written to in gpsLog.                  *|
|*-----------------+-------------------------------------------------------------------------------*|
|* int gpsLogOn    | This int is declares whether the gpsLog is being written to.                  *|
\*=================================================================================================*/

persistent int gpsLog[GPS_LOG_LENGTH][4];
int gpsLogIndex = 0;
int gpsLogOn = 0;

/*=================================================================================================*\
|* Functions                                                                                       *|
\*=================================================================================================*/

/*-------------------------------------------------------------------------------------------------*\
|* void ResetGPSLog()                                                                              *|
|*-------------------------------------------------------------------------------------------------*|
|* Purpose: Resets the data in gpsLog and prepares writing for the current execution.              *|
\*-------------------------------------------------------------------------------------------------*/

void ResetGPSLog()
{
    int index = 0;
    printf("\nResetting GPS  Log");
    while(index < GPS_LOG_LENGTH)
      {
        gpsLog[index][0] = 0;
        gpsLog[index][1] = 0;
        gpsLog[index][2] = 0;
        gpsLog[index][3] = 0;
        index++;
    }
    gpsLogIndex = 0;
}

/*-------------------------------------------------------------------------------------------------*\
|* void StartGPSLogging()                                                                          *|
|*-------------------------------------------------------------------------------------------------*|
|* Purpose: Begins logging for the current execution.                                              *|
\*-------------------------------------------------------------------------------------------------*/

void StartGPSLogging()
{
    gpsLogOn = 1;
}

/*-------------------------------------------------------------------------------------------------*\
|* void StopLogging()                                                                              *|
|*-------------------------------------------------------------------------------------------------*|
|* Purpose: Stops logging for the current execution.                                               *|
\*-------------------------------------------------------------------------------------------------*/

void StopGPSLogging()
{
    gpsLogOn = 0;
}

/*-------------------------------------------------------------------------------------------------*\
|* void LogGPS()                                                                                   *|
|*-------------------------------------------------------------------------------------------------*|
|* Purpose: Logs the current GPS values at the current gpsLogIndex in gpsLog                       *|
\*-------------------------------------------------------------------------------------------------*/

void LogGPS(int x, int y, int heading, int facingLeft)
{
    if(gpsLogIndex < GPS_LOG_LENGTH && gpsLogOn)
      {
        gpsLog[gpsLogIndex][0] = x;
        gpsLog[gpsLogIndex][1] = y;
        gpsLog[gpsLogIndex][2] = heading;
        gpsLog[gpsLogIndex][3] = facingLeft;
        gpsLogIndex++;
    }
}

/*=================================================================================================*\
|* END                                                                                             *|
\*=================================================================================================*/
